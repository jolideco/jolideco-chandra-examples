from sherpa.astro.ui import *

set_stat("chi2datavar")

set_method("levmar")
set_xsabund("wilm")
set_xsxsect("vern")
set_xscosmo(70, 0, 0.73)
set_xsxset("APECROOT", "NoLine_v1.3.1")
set_xsxset("FORCECALC", "on")

# model  constant(gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + gaussian + TBabs*TBvarabs(apec + apec))
m1 = create_model_component("xsconstant", "m1")
m2 = create_model_component("xsgaussian", "m2")
m3 = create_model_component("xsgaussian", "m3")
m4 = create_model_component("xsgaussian", "m4")
m5 = create_model_component("xsgaussian", "m5")
m6 = create_model_component("xsgaussian", "m6")
m7 = create_model_component("xsgaussian", "m7")
m8 = create_model_component("xsgaussian", "m8")
m9 = create_model_component("xsgaussian", "m9")
m10 = create_model_component("xsgaussian", "m10")
m11 = create_model_component("xsgaussian", "m11")
m12 = create_model_component("xsgaussian", "m12")
m13 = create_model_component("xsgaussian", "m13")
m14 = create_model_component("xsgaussian", "m14")
m15 = create_model_component("xsgaussian", "m15")
m16 = create_model_component("xsgaussian", "m16")
m17 = create_model_component("xsgaussian", "m17")
m18 = create_model_component("xsgaussian", "m18")
m19 = create_model_component("xsgaussian", "m19")
m20 = create_model_component("xsgaussian", "m20")
m21 = create_model_component("xsgaussian", "m21")
m22 = create_model_component("xsgaussian", "m22")
m23 = create_model_component("xsgaussian", "m23")
m24 = create_model_component("xsgaussian", "m24")
m25 = create_model_component("xsgaussian", "m25")
m26 = create_model_component("xsgaussian", "m26")
m27 = create_model_component("xsgaussian", "m27")
m28 = create_model_component("xsgaussian", "m28")
m29 = create_model_component("xsgaussian", "m29")
m30 = create_model_component("xsgaussian", "m30")
m31 = create_model_component("xsgaussian", "m31")
m32 = create_model_component("xsgaussian", "m32")
m33 = create_model_component("xsgaussian", "m33")
m34 = create_model_component("xsgaussian", "m34")
m35 = create_model_component("xsgaussian", "m35")
m36 = create_model_component("xsgaussian", "m36")
m37 = create_model_component("xsgaussian", "m37")
m38 = create_model_component("xsgaussian", "m38")
m39 = create_model_component("xsgaussian", "m39")
m40 = create_model_component("xsgaussian", "m40")
m41 = create_model_component("xsgaussian", "m41")
m42 = create_model_component("xsgaussian", "m42")
m43 = create_model_component("xsgaussian", "m43")
m44 = create_model_component("xsgaussian", "m44")
m45 = create_model_component("xsgaussian", "m45")
m46 = create_model_component("xsgaussian", "m46")
m47 = create_model_component("xsgaussian", "m47")
m48 = create_model_component("xsgaussian", "m48")
m49 = create_model_component("xsgaussian", "m49")
m50 = create_model_component("xsgaussian", "m50")
m51 = create_model_component("xsgaussian", "m51")
m52 = create_model_component("xsgaussian", "m52")
m53 = create_model_component("xsgaussian", "m53")
m54 = create_model_component("xstbabs", "m54")
m55 = create_model_component("xstbvarabs", "m55")
m56 = create_model_component("xsapec", "m56")
m57 = create_model_component("xsapec", "m57")
set_par(m1.factor, 1, frozen=True)
set_par(m2.LineE, 2.0052, min=1.99, max=2.3, frozen=True)
set_par(m2.Sigma, 0.01, max=0.01, frozen=True)
set_par(m2.norm, 1.12532e-05, frozen=True)
set_par(m3.LineE, 1.865, min=1.8, max=1.9, frozen=True)
set_par(m3.Sigma, 0.0047, max=0.02, frozen=True)
set_par(m3.norm, 3.46e-05, frozen=True)
link(m4.LineE, m3.LineE * 0.9941)
link(m4.Sigma, m3.Sigma)
link(m4.norm, 0.1 * m3.norm)
link(m5.LineE, m3.LineE * 0.9861)
link(m5.Sigma, m3.Sigma)
link(m5.norm, 0.4 * m3.norm)
set_par(m6.LineE, 1.745, min=1.68, max=1.79, frozen=True)
set_par(m6.Sigma, 0.0139335, max=0.02, frozen=True)
set_par(m6.norm, 2.97537e-05, frozen=True)
set_par(m7.LineE, 1.659, min=1.6, max=1.7, frozen=True)
set_par(m7.Sigma, 0.0077472, max=0.02, frozen=True)
link(m7.norm, m13.norm * 0.14791)
set_par(m8.LineE, 1.579, min=1.54, max=1.64, frozen=True)
set_par(m8.Sigma, 0.0119515, max=0.02, frozen=True)
link(m8.norm, m13.norm * 0.46567)
set_par(m9.LineE, 1.4721, min=1.44, max=1.5, frozen=True)
set_par(m9.Sigma, 0.00580145, max=0.02, frozen=True)
set_par(m9.norm, 0.000110183, frozen=True)
set_par(m10.LineE, 1.4317, min=1.41, max=1.45, frozen=True)
set_par(m10.Sigma, 1.68487e-05, max=0.01, frozen=True)
set_par(m10.norm, 8.13226e-06, frozen=True)
set_par(m11.LineE, 1.3522, min=1.32, max=1.4, frozen=True)
set_par(m11.Sigma, 0.0059182, max=0.02, frozen=True)
link(m11.norm, m13.norm * 2.12622)
link(m12.LineE, m11.LineE * 0.99330)
link(m12.Sigma, m11.Sigma)
link(m12.norm, m13.norm * 0.25330)
link(m13.LineE, m11.LineE * 0.98440)
link(m13.Sigma, m11.Sigma)
set_par(m13.norm, 0.000108671, frozen=True)
set_par(m14.LineE, 1.308, min=1.29, max=1.32, frozen=True)
set_par(m14.Sigma, 0.00584917, max=0.01, frozen=True)
set_par(m14.norm, 3.71185e-05, frozen=True)
set_par(m15.LineE, 1.277, min=1.24, max=1.31, frozen=True)
set_par(m15.Sigma, 0.00727638, max=0.02, frozen=True)
link(m15.norm, m21.norm * 0.05693)
set_par(m16.LineE, 1.211, min=1.18, max=1.23, frozen=True)
set_par(m16.Sigma, 0.0047867, max=0.02, frozen=True)
link(m16.norm, m21.norm * 0.14669)
set_par(m17.LineE, 1.168, min=1.14, max=1.18, frozen=True)
set_par(m17.Sigma, 0.02, max=0.02, frozen=True)
set_par(m17.norm, 0.000173514, frozen=True)
set_par(m18.LineE, 1.127, min=1.09, max=1.14, frozen=True)
set_par(m18.Sigma, 0.00474718, max=0.02, frozen=True)
set_par(m18.norm, 0.000123073, frozen=True)
set_par(m19.LineE, 1.074, min=1.06, max=1.08, frozen=True)
set_par(m19.Sigma, 0.00457052, max=0.02, frozen=True)
set_par(m19.norm, 0.000320725, frozen=True)
set_par(m20.LineE, 1.0564, min=1.05, max=1.06, frozen=True)
set_par(m20.Sigma, 0.00166652, max=0.01, frozen=True)
set_par(m20.norm, 2.42077e-05, frozen=True)
set_par(m21.LineE, 1.0217, min=1.01, max=1.03, frozen=True)
set_par(m21.Sigma, 0.00372799, max=0.02, frozen=True)
set_par(m21.norm, 0.00137825)
set_par(m22.LineE, 0.9668, min=0.963, max=0.969, frozen=True)
set_par(m22.Sigma, 0.01, max=0.01, frozen=True)
set_par(m22.norm, 0.000120539, frozen=True)
set_par(m23.LineE, 0.9221, min=0.92, max=0.95, frozen=True)
set_par(m23.Sigma, 0.00277343, max=0.02, frozen=True)
set_par(m23.norm, 0.00138048, max=0.02)
link(m24.LineE, m23.LineE * 0.9947945)
set_par(m24.Sigma, 0.00127615, max=10, frozen=True)
set_par(m24.norm, 0, frozen=True)
link(m25.LineE, m23.LineE * 0.99220)
set_par(m25.Sigma, 0.00151304, max=10, frozen=True)
link(m25.norm, m23.norm * 0.180829)
link(m26.LineE, m23.LineE * 0.98170)
set_par(m26.Sigma, 0.00375397, max=0.02, frozen=True)
link(m26.norm, m23.norm * 0.5)
set_par(m27.LineE, 0.8503, min=0.83, max=0.87, frozen=True)
set_par(m27.Sigma, 0.0175157, max=0.02, frozen=True)
set_par(m27.norm, 0.000407269, frozen=True)
set_par(m28.LineE, 0.8726, min=0.85, max=0.88, frozen=True)
set_par(m28.Sigma, 0.00756978, max=0.02, frozen=True)
set_par(m28.norm, 8.96644e-05, frozen=True)
set_par(m29.LineE, 0.8258, min=0.82, max=0.83, frozen=True)
set_par(m29.Sigma, 0.00194124, max=0.02, frozen=True)
set_par(m29.norm, 6.51455e-05, frozen=True)
set_par(m30.LineE, 0.8365, min=0.83, max=0.84, frozen=True)
set_par(m30.Sigma, 0.00236052, max=0.02, frozen=True)
set_par(m30.norm, 6.2672e-05, frozen=True)
set_par(m31.LineE, 0.817, min=0.81, max=0.82, frozen=True)
set_par(m31.Sigma, 0.00265515, max=0.02, frozen=True)
set_par(m31.norm, 0.000243118, frozen=True)
set_par(m32.LineE, 0.8125, frozen=True)
set_par(m32.Sigma, 0.00348681, max=0.015, frozen=True)
set_par(m32.norm, 9.04887e-05, frozen=True)
set_par(m33.LineE, 0.7748, min=0.77, max=0.78, frozen=True)
set_par(m33.Sigma, 0.00277218, max=0.02, frozen=True)
set_par(m33.norm, 0.000788605, frozen=True)
set_par(m34.LineE, 0.7389, min=0.73, max=0.75, frozen=True)
set_par(m34.Sigma, 0.00205396, max=0.02, frozen=True)
set_par(m34.norm, 8.22931e-05, frozen=True)
set_par(m35.LineE, 0.7271, min=0.72, max=0.73, frozen=True)
set_par(m35.Sigma, 0.00469893, max=0.02, frozen=True)
set_par(m35.norm, 0.000165874, frozen=True)
set_par(m36.LineE, 0.7252, frozen=True)
set_par(m36.Sigma, 0.00322351, max=10, frozen=True)
set_par(m36.norm, 0.000130935, frozen=True)
set_par(m37.LineE, 0.7127, min=0.705, max=0.72, frozen=True)
set_par(m37.Sigma, 0.00271444, max=0.005, frozen=True)
set_par(m37.norm, 0.000124913, frozen=True)
set_par(m38.LineE, 0.6978, min=0.69, max=0.705, frozen=True)
set_par(m38.Sigma, 0.00243363, max=0.02, frozen=True)
link(m38.norm, m43.norm * 0.17981)
link(m39.LineE, m40.LineE * 1.0184)
set_par(m39.Sigma, 0.00179513, max=0.02, frozen=True)
link(m39.norm, m40.norm * 0.11402)
set_par(m40.LineE, 0.6536, min=0.648, max=0.66, frozen=True)
set_par(m40.Sigma, 0.00231828, max=0.02, frozen=True)
set_par(m40.norm, 0.00439334)
set_par(m41.LineE, 0.5739, min=0.568, max=0.58, frozen=True)
set_par(m41.Sigma, 0.00178805, max=0.02, frozen=True)
link(m41.norm, m43.norm * 2.09009)
link(m42.LineE, m41.LineE * 0.9908)
link(m42.Sigma, m41.Sigma)
link(m42.norm, m43.norm * 0.37648)
link(m43.LineE, m41.LineE * 0.9775)
link(m43.Sigma, m41.Sigma)
set_par(m43.norm, 0.00131324)
set_par(m44.LineE, 0.459499, min=0.455, max=0.463, frozen=True)
set_par(m44.Sigma, 0.00158112, max=0.015, frozen=True)
link(m44.norm, m51.norm * 0.15582)
set_par(m45.LineE, 0.435551, frozen=True)
set_par(m45.Sigma, 0.00125027, max=0.002, frozen=True)
link(m45.norm, m51.norm * 0.28253)
link(m46.LineE, m45.LineE * 0.9892)
link(m46.Sigma, m45.Sigma)
set_par(m46.norm, 1.05137e-05, frozen=True)
link(m47.LineE, m45.LineE * 0.9789)
link(m47.Sigma, m45.Sigma)
set_par(m47.norm, 2.00575e-06, frozen=True)
link(m48.LineE, m45.LineE * 0.9637)
link(m48.Sigma, m45.Sigma)
set_par(m48.norm, 6.85451e-06, frozen=True)
link(m49.LineE, m45.LineE * 0.9353)
link(m49.Sigma, m45.Sigma)
set_par(m49.norm, 1.18531e-05, frozen=True)
set_par(m50.LineE, 0.3826, min=0.375, max=0.39, frozen=True)
set_par(m50.Sigma, 0.00223503, max=0.005, frozen=True)
set_par(m50.norm, 1.84754e-05, frozen=True)
set_par(m51.LineE, 0.3675, min=0.36, max=0.375, frozen=True)
set_par(m51.Sigma, 0.00123973, max=0.005, frozen=True)
set_par(m51.norm, 0.000175218, frozen=True)
set_par(m52.LineE, 2.18177, frozen=True)
set_par(m52.Sigma, 0.01, max=10, frozen=True)
set_par(m52.norm, 4.37154e-06, frozen=True)
set_par(m53.LineE, 2.4503, min=2.3, max=2.5, frozen=True)
set_par(m53.Sigma, 0.01, max=0.1, frozen=True)
set_par(m53.norm, 1.27364e-05, frozen=True)
set_par(m54.nH, 0.0536, max=100000, frozen=True)
set_par(m55.nH, 0.0575646, max=100000, frozen=True)
set_par(m55.He, 0.8321, frozen=True)
set_par(m55.C, 0.2238, frozen=True)
set_par(m55.N, 0.0563, frozen=True)
set_par(m55.O, 0.2184, frozen=True)
set_par(m55.Ne, 0.2135, frozen=True)
set_par(m55.Na, 0.629, frozen=True)
set_par(m55.Mg, 0.3805, frozen=True)
set_par(m55.Al, 1, frozen=True)
set_par(m55.Si, 0.0575, frozen=True)
set_par(m55.S, 0.3163, frozen=True)
set_par(m55.Cl, 0.3795, frozen=True)
set_par(m55.Ar, 0.2514, frozen=True)
set_par(m55.Ca, 0.3101, frozen=True)
set_par(m55.Cr, 0.3889, frozen=True)
set_par(m55.Fe, 0.2572, frozen=True)
set_par(m55.Co, 0.3, frozen=True)
set_par(m55.Ni, 0.6321, frozen=True)
set_par(m55.H2, 0.2, frozen=True)
set_par(m55.rho, 1, frozen=True)
set_par(m55.amin, 0.025, frozen=True)
set_par(m55.amax, 0.25, frozen=True)
set_par(m55.PL, 3.5, frozen=True)
set_par(m55.H_dep, 1, frozen=True)
set_par(m55.He_dep, 1, frozen=True)
set_par(m55.C_dep, 1, frozen=True)
set_par(m55.N_dep, 1, frozen=True)
set_par(m55.O_dep, 1, frozen=True)
set_par(m55.Ne_dep, 1, frozen=True)
set_par(m55.Na_dep, 1, frozen=True)
set_par(m55.Mg_dep, 1, frozen=True)
set_par(m55.Al_dep, 1, frozen=True)
set_par(m55.Si_dep, 1, frozen=True)
set_par(m55.S_dep, 1, frozen=True)
set_par(m55.Cl_dep, 1, frozen=True)
set_par(m55.Ar_dep, 1, frozen=True)
set_par(m55.Ca_dep, 1, frozen=True)
set_par(m55.Cr_dep, 1, frozen=True)
set_par(m55.Fe_dep, 1, frozen=True)
set_par(m55.Co_dep, 1, frozen=True)
set_par(m55.Ni_dep, 1, frozen=True)
set_par(m55.redshift, 0, min=0, frozen=True)
set_par(m56.kT, 1.73629, min=0.5, max=5, frozen=True)
set_par(m56.Abundanc, 1, frozen=True)
set_par(m56.redshift, 0, min=0, max=2, frozen=True)
set_par(m56.norm, 0.00185054, frozen=True)
set_par(m57.kT, 0.163732, frozen=True)
set_par(m57.Abundanc, 1, frozen=True)
set_par(m57.redshift, 0, min=0, max=2, frozen=True)
set_par(m57.norm, 0.0348107, frozen=True)

# Set up the model expressions
#
set_source(
    1,
    m1
    * (
        m2
        + m3
        + m4
        + m5
        + m6
        + m7
        + m8
        + m9
        + m10
        + m11
        + m12
        + m13
        + m14
        + m15
        + m16
        + m17
        + m18
        + m19
        + m20
        + m21
        + m22
        + m23
        + m24
        + m25
        + m26
        + m27
        + m28
        + m29
        + m30
        + m31
        + m32
        + m33
        + m34
        + m35
        + m36
        + m37
        + m38
        + m39
        + m40
        + m41
        + m42
        + m43
        + m44
        + m45
        + m46
        + m47
        + m48
        + m49
        + m50
        + m51
        + m52
        + m53
        + m54 * m55 * (m56 + m57)
    ),
)
